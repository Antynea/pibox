<Directory "/var/www/rutorrent/">
  AuthType Basic
  AuthName "Pibox WebUI"
  AuthBasicProvider file
  AuthUserFile "/opt/rtorrent/.htpasswd"
  Require valid-user
</Directory>

# you shouldn't open up your pibox w/o ssl
# but if you really want to... here it is:
#<VirtualHost *:80>
#  ServerName localhost
#  DocumentRoot /var/www/rutorrent/
#  ServerSignature Off
#</VirtualHost>

<VirtualHost *:443>

  ServerName localhost
  DocumentRoot /var/www/rutorrent/
  ServerSignature Off

  SSLEngine on
  SSLCertificateFile /opt/rtorrent/ssl.crt
  SSLCertificateKeyFile /opt/rtorrent/ssl.key

  SSLCipherSuite AES128+EECDH:AES128+EDH
  SSLProtocol All -SSLv2 -SSLv3
  SSLHonorCipherOrder On
  Header always set Strict-Transport-Security "max-age=63072000; includeSubDomains"
  Header always set X-Frame-Options DENY
  Header always set X-Content-Type-Options nosniff
  SSLCompression off
  SSLUseStapling on

  Alias /stream /var/www/cakebox/public/
  <Directory /var/www/cakebox/public/>
      Options Indexes MultiViews FollowSymLinks
      AllowOverride All

      <IfVersion >= 2.4>
    Require all granted
      </IfVersion>
      <IfVersion < 2.4>
    Order allow,deny
    Allow from all
      </IfVersion>

      SetEnv APPLICATION_ENV production

      RewriteEngine On
      RewriteBase /stream/
      RewriteCond %{REQUEST_FILENAME} !-f
      RewriteRule ^ index.php [QSA,L]
  </Directory>

  Alias /access /opt/rtorrent/share/
  <Directory "/opt/rtorrent/share/">
      Options -Indexes

      <IfVersion >= 2.4>
    Require all granted
      </IfVersion>
      <IfVersion < 2.4>
    Order allow,deny
    Allow from all
      </IfVersion>
      Satisfy Any

      Header set Content-Disposition "attachment"
  </Directory>

</VirtualHost>

SSLStaplingCache "shmcb:logs/stapling-cache(150000)"

